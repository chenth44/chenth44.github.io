---
share: true
---

# An observation-based distance measure for covariance models

Suppose we have two covariance models $A$ and $B$. We want to define the distance $d(A, B)$ between these models.

## Requirements

1. Non-negativity: $d(A, B) \geq 0$;
2. Commutativity: $d(A, B) = d(B, A)$;
3. Reflexivity: $d(A, A) = 0$;
4. Triangle inequality: $d(A, B) + d(B, C) \geq d(A, C)$.

---

## An observation-based distance measure

$$
d(A, B) \triangleq \left | \log \Pr (O \mid A) - \log \Pr (O \mid B) \right |,
$$

where $O$ is a sequence of observations generated by a covariance model. In this case, **all these requirements above are satisfied**.

Suppose $A_i$ is an existed CM, and $B$ is a newly defined CM. We want to compare $B$ with all $A_1, A_2, \cdots, A_N$ to find the most similar CM.
Let $O_B$ be a sequence of observations generated by $B$. Then we can assume $\Pr (O_B \mid B) > \Pr (O_B \mid A)$ when $O_B$ **is large enough**.
$$
\underset{i}{\text{argmin}}\,d(A_i, B) = \underset{i}{\text{argmax}}\, \sum_k\log \frac{\Pr (o_{Bk} \mid A_i)}{\Pr (o_{Bk} \mid N)} \quad (\text{sum of bit scores})
$$
where $N$ is the null model. 
Therefore, the CM with the highest bit score sum is the most similar model to $B$.

---

## Find the most similar CM using Infernal

### cmemit: randomly generate sequences from the covariance model

### cmscan: search the input sequence against covariance model(s)
